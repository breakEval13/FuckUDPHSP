<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>公共代理设置</title>
<link href="https://zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="c360" id="公共代理设置">公共代理设置</h1><p data-anchor-id="0my1"><code>gozap</code></p><hr><blockquote data-anchor-id="s4g6" class="white-blockquote">
  <p>目前在 172.16.0.19 上开启了公共代理，监听 1083 端口，仅支持 socks5 协议；本地可将任意支持 socks5 代理的程序指向 172.16.0.19:1083 实现翻墙，以下仅提供 chrome、Linux 命令行、DOcker 设置</p>
</blockquote><div class="md-section-divider"></div><h3 data-anchor-id="3lxy" id="一chrome-代理">一、Chrome 代理</h3><div class="md-section-divider"></div><h4 data-anchor-id="i65v" id="11安装扩展">1.1、安装扩展</h4><p data-anchor-id="zvfd">Chrome 代理需要使用指定扩展插件( <code>SwitchyOmega</code> )以实现 PAC 功能(根据网址自动代理)，安装插件只需要将 crx 文件拖入插件列表即可</p><p data-anchor-id="9qcm"><img src="http://static.zybuluo.com/mritd/oqrhdjr6j14l256w65ngvnnj/image_1b636ujg01vfv10d61jtt18um1mqa9.png" alt="image_1b636ujg01vfv10d61jtt18um1mqa9.png-184.5kB"></p><p data-anchor-id="99wi"><img src="http://static.zybuluo.com/mritd/zixqsberjqyiesvu3b4k4im6/image_1b6370d0h1hhu1oggvoc1sgvobdm.png" alt="image_1b6370d0h1hhu1oggvoc1sgvobdm.png-113.9kB"></p><div class="md-section-divider"></div><h4 data-anchor-id="lqjq" id="12导入规则">1.2、导入规则</h4><p data-anchor-id="8gxo">安装完成后默认会跳到插件设置页面，各种提示可直接选择跳过；然后选择导入与导出选项，选择 bak 文件导入规则</p><p data-anchor-id="7huj"><img src="http://static.zybuluo.com/mritd/vards4g0ya4qo49diysi3e9z/image_1b6376gcgj2fm7ivr81acu190013.png" alt="image_1b6376gcgj2fm7ivr81acu190013.png-203.6kB"></p><div class="md-section-divider"></div><h4 data-anchor-id="i4z6" id="13调整自动切换模式">1.3、调整自动切换模式</h4><p data-anchor-id="887d">导入规则后默认会出现 4 个选项:</p><ul data-anchor-id="ctu9">
<li>Shaowsocks : 默认指向了 127.0.0.1 1080 端口(socks5 协议)，此模式将转发所有流量到本地 1080 端口，适用于在本地开启 shadowsocks 客户端的情况下使用</li>
<li>localtcp : 默认指向了 127.0.0.1 1083 端口(socks5 协议)，此模式将所有流量转发到本地 1083 端口，适用于在本地开启 tcpspeed 客户端的情况下使用</li>
<li>tcpspeed : 默认指向 172.16.0.19 1083 端口(socks5 协议)，此模式将所有流量转发到 172.16.0.19 公共代理服务器的 1083 端口，172.16.0.19 运行着一个监听 1083 端口的 tcpspeed 客户端</li>
<li><strong>自动切换</strong> : <strong>根据内置的列表规则，针对不同域名选择不同的代理模式，实现智能切换</strong></li>
</ul><p data-anchor-id="wrd3">正常使用只需要将模式切换成 <code>自动切换</code>，如下所示</p><p data-anchor-id="ghvg"><img src="http://static.zybuluo.com/mritd/rlcy4wd5d7k180svjvs76f0n/QQ%E5%9B%BE%E7%89%8720170110114733.jpg" alt="QQ图片20170110114733.jpg-42.8kB" title=""></p><p data-anchor-id="6s66"><strong>自动切换模式默认有一个规则列表，如果当前访问的域名命中规则列表，则会自动根据预先设置的代理模式进行代理</strong></p><p data-anchor-id="xr6r"><img src="http://static.zybuluo.com/mritd/zqzrihjy3lh43dta1o8h88iv/image_1b6384hkbjuj181a17k08orpov1s.png" alt="image_1b6384hkbjuj181a17k08orpov1s.png-123.8kB"></p><p data-anchor-id="xxzi"><img src="http://static.zybuluo.com/mritd/ac1inhvtzi23c6tug5uez3w6/image_1b6386o12hj9deb15hq16sb11fa29.png" alt="image_1b6386o12hj9deb15hq16sb11fa29.png-167kB"></p><p data-anchor-id="r10s"><strong>也就是说，首先选择自动切换模式，然后将自动切换模式下的预定义代理模式切换成 tcpseppd，此时访问谷歌将会自动走代理，访问百度将直接链接</strong></p><p data-anchor-id="b5si"><img src="http://static.zybuluo.com/mritd/jmugxr0vhqa46ym3yusqebb0/image_1b638dh8ill310e41sp5cagkun2m.png" alt="image_1b638dh8ill310e41sp5cagkun2m.png-52.8kB"></p><p data-anchor-id="xfbc"><img src="http://static.zybuluo.com/mritd/dm9axuugvvylihmm8gfxq27a/image_1b638ffo41f351q813pb1ut12vm33.png" alt="image_1b638ffo41f351q813pb1ut12vm33.png-51.6kB"></p><div class="md-section-divider"></div><h4 data-anchor-id="4a22" id="14强制代理和自定义规则">1.4、强制代理和自定义规则</h4><p data-anchor-id="bfwv">某些网站并未完全被墙，但是访问收到干扰，表现为速度奇慢，比如 Github；在自动切换模式下，由于 Github 并未被墙，所以规则列表中不会存在，访问也不会走代理；如果想强制走代理，可以通过更改代理模式为 tcpspeed 来实现，<strong>但此时所有流量将全部通过代理转发</strong></p><p data-anchor-id="0epr"><img src="http://static.zybuluo.com/mritd/kbxaqdkzrg852ishetlikvwd/image_1b638ra7d1n1c1hd11v1ktfm1ibq9.png" alt="image_1b638ra7d1n1c1hd11v1ktfm1ibq9.png-48.4kB"></p><p data-anchor-id="k9j1">为了解决这个问题，自动切换模式下提供了自定义规则功能，即可以自己将指定域名加入到需要代理的列表中</p><p data-anchor-id="6jhk"><img src="http://static.zybuluo.com/mritd/inrs3zy9sc609axu5gmxavjw/image_1b638ugg71p07mbo5qe4nfq5m.png" alt="image_1b638ugg71p07mbo5qe4nfq5m.png-66.1kB"></p><p data-anchor-id="0bcx"><img src="http://static.zybuluo.com/mritd/52yfiwfxb86qqh24rdm99yba/image_1b6390fq21aug1mnc9fd145c18it13.png" alt="image_1b6390fq21aug1mnc9fd145c18it13.png-46.3kB"></p><p data-anchor-id="ze73">此后只要访问 <code>*.github.com</code> 将会自动走 tcpspeed，如果需要取消规则，在自动切换设置中可以手动删除</p><p data-anchor-id="wmr3"><img src="http://static.zybuluo.com/mritd/6fqa53pe00cyzv9jye8p7l8k/image_1b63935ua1l1l1jed1p8q1hpu4pl1g.png" alt="image_1b63935ua1l1l1jed1p8q1hpu4pl1g.png-55.4kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="4sny" id="二linux-命令行下使用">二、Linux 命令行下使用</h3><p data-anchor-id="6vmv">参考 <a href="https://mritd.me/2016/07/22/Linux-%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E4%BD%BF%E7%94%A8-Shadowsocks-%E4%BB%A3%E7%90%86/#socks5--http-" target="_blank">这里</a></p><div class="md-section-divider"></div><h3 data-anchor-id="jvqf" id="三docker-设置代理">三、Docker 设置代理</h3><p data-anchor-id="ns8m">参考 <a href="https://github.com/mritd/shell_scripts/blob/master/docker_proxy.sh" target="_blank">此脚本</a>，将 <code>HTTP_PROXY=http://192.168.1.120:8123</code> 换成 <code>ALL_PROXY=socks5://172.16.0.19:1083</code> 即可</p></div>
</body>
</html>